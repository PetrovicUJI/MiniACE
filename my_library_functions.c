/**
 * \file  my_library_functions.c
 * \brief Holds user created library functions.
 */
#include "header.h"
#include "my_library_header.h"

/** \fn int random_int(int min,int max)
 * \brief Returns an integer between and including min and max
 * \param min The minimum integer.
 * \param max The maximum integer.
 * \return The random integer.
 */
int random_int(int min,int max)
{
    return min + rand() % (max - min + 1);
}


/* A fast algorithm to generate a number drawn from a normal distribution of mean 0 and std 1.0.
 The implementation is taken from EURACE1.0 financial market model with a simple adoption.
 The method needs to be double checked.
 */

double old_ierf[]={ -3.6427727,-1.8213863677184485,-1.6449763571331872,-1.5344856217777185,-1.4522197815622468,-1.3859038243496775,
    -1.3299219143360630,-1.2812143237490619,-1.2379219927112444,-1.1988272177415733,-1.1630871536766743,-1.1300932068852447,
    -1.0993909519492191,-1.0706317121429472,-1.0435418436397585,-1.0179024648320276,-0.99353562834730424,-0.97029461851300924,
    -0.94805697623234997,-0.92671937749552902,-0.90619380243682324,-0.88640462220354344,-0.86728635099387485,-0.84878188837096091,
    -0.83084112847456015,-0.81341984759761865,-0.79647880561170736,-0.77998301356170241,-0.76390113173723651,-0.74820497118498519,
    -0.73286907795921674,-0.71787038409775483,-0.70318791282203608,-0.68880252811655640,-0.67469672087225274,-0.66085442534238581,
    -0.64726086087507340,-0.63390239483887112,-0.62076642340926991,-0.60784126748116207,-0.59511608144999473,-0.58258077298879651,
    -0.57022593225950946,-0.55804276925044749,-0.54602305813905516,-0.53415908774970244,-0.52244361731717903,-0.51086983688356091,
    -0.49943133175366350,-0.48812205051595892,-0.47693627620446988,-0.46586860023505738,-0.45491389879854005,-0.44406731143474232,
    -0.43332422154706796,-0.42268023864756182,-0.41213118214846539,-0.40167306653867352,-0.39130208780283204,-0.38101461095753197,
    -0.37080715859355801,-0.36067640032575804,-0.35061914306308928,-0.34063232202099475,-0.33071299240667357,-0.32085832171518147,
    -0.31106558258078476,-0.30133214613370579,-0.29165547581744200,-0.28203312162630179,-0.27246271472675426,-0.26294196242969720,
    -0.25346864348386577,-0.24404060366338223,-0.23465575162492167,-0.22531205501217810,-0.21600753678729465,-0.20674027177068635,
    -0.19750838337227367,-0.18831004049856323,-0.17914345462129161,-0.17000687699449396,-0.16089859600789128,-0.15181693466541812,
    -0.14276024817854746,-0.13372692166481973,-0.12471536794266060,-0.11572402541417945,-0.10675135602818442,-9.77958433161436186E-002,
    -8.88559904942576584E-002,-7.99303186252031533E-002,-7.10173648334547075E-002,-6.21156805684038721E-002,-5.32238299097659295E-002,
    -4.43403879100054410E-002,-3.54639389687185780E-002,-2.65930752340884334E-002,-1.77263950266780337E-002,-8.86250128095060485E-003,
    0.0000000000000000,8.86250128095060485E-003,1.77263950266780337E-002,2.65930752340884334E-002,3.54639389687186751E-002,4.43403879100055381E-002,
    5.32238299097660267E-002,6.21156805684039623E-002,7.10173648334548047E-002,7.99303186252032505E-002,8.88559904942577555E-002,9.77958433161437157E-002,
    0.10675135602818452,0.11572402541417953,0.12471536794266071,0.13372692166481984,0.14276024817854766,0.15181693466541812,0.16089859600789128,
    0.17000687699449396,0.17914345462129161,0.18831004049856323,0.19750838337227367,0.20674027177068635,0.21600753678729465,0.22531205501217810,
    0.23465575162492167,0.24404060366338223,0.25346864348386577,0.26294196242969731,0.27246271472675437,0.28203312162630190,0.29165547581744211,
    0.30133214613370585,0.31106558258078487,0.32085832171518158,0.33071299240667368,0.34063232202099486,0.35061914306308933,0.36067640032575810,
    0.37080715859355812,0.38101461095753208,0.39130208780283204,0.40167306653867352,0.41213118214846539,0.42268023864756182,0.43332422154706796,
    0.44406731143474232,0.45491389879854005,0.46586860023505738,0.47693627620446988,0.48812205051595892,0.49943133175366350,0.51086983688356091,
    0.52244361731717903,0.53415908774970244,0.54602305813905516,0.55804276925044749,0.57022593225950968,0.58258077298879662,0.59511608144999506,
    0.60784126748116218,0.62076642340927002,0.63390239483887123,0.64726086087507384,0.66085442534238614,0.67469672087225296,0.68880252811655662,
    0.70318791282203608,0.71787038409775483,0.73286907795921674,0.74820497118498519,0.76390113173723651,0.77998301356170241,0.79647880561170736,
    0.81341984759761865,0.83084112847456015,0.84878188837096091,0.86728635099387485,0.88640462220354344,0.90619380243682324,0.92671937749552902,
    0.94805697623234997,0.97029461851300935,0.99353562834730447,1.0179024648320278,1.0435418436397590,1.0706317121429476,1.0993909519492193,
    1.1300932068852454,1.1630871536766747,1.1988272177415735,1.2379219927112453,1.2812143237490619,1.3299219143360630,1.3859038243496775,
    1.4522197815622468,1.5344856217777185,1.6449763571331872,1.8213863677184485,3.6427727};


double fast_gauss_distro()
{
    int i;
    double r, unif, rand_choice, previous;
    
    rand_choice = (double)random_int(0, 999) / 1000.0;
    
    unif = rand_choice * 200;
    i= (int)(unif);
    previous = old_ierf[i];
    r = (previous + (old_ierf[i+1] - previous) * (unif - i));
    
    return r;
}
